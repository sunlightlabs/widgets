<% content_for :head do %>
  <%= stylesheet_link_tag 'colorpicker' %>
  <%= javascript_include_tag 'colorpicker' %>
  <script type="text/javascript" charset="utf-8">
  
    var widget_size = 'lg';
    var widget_color = '#1F83B5';
    
    var sizes = {sm: [160, 300], med: [300, 250], lg: [400,300]};
    
    $(document).ready(function() {
    
      $("li.switcherbtn a").click(function() {
        var new_size = $(this).attr('id');
        if (new_size != widget_size) {
          widget_size = new_size;
          updateFrame();
        }
        return false;
      });
      
      $("#primaryColor").change(function() {
        widget_color = $("#primaryColor").attr('value');
        updateFrame();
      });
      
      $("button#generate").click(function() {
        var embed_url = "http://" + "<%= settings[:frontend_hostname] %>" + "/embed?w=" + "<%= params[:id] %>" + "&bgd=" + "<%= params[:bioguide_id] %>" + "&s=" + widget_size + '&color=' + widget_color;
        
        $('input#grabCode').attr('value', "<script type='text\/javascript' src='" + embed_url + "'><\/script>");
      });
    });
    
    function updateFrame() {
      var iframe_url = "http://<%= settings[:frontend_hostname] %>/widgets/<%= params[:id] %>/embed?bioguide_id=<%= params[:bioguide_id] %>";
      
      iframe_url += "&size=" + widget_size + "&color=" + widget_color;
      
      $("#widgetConstruct iframe").attr("src", iframe_url)
        .attr("width", sizes[widget_size][0])
        .attr("height", sizes[widget_size][1]);
    }
    
  </script>
<% end %>

<h2><%= h(@widget[:name] + " for " + search_name_for(@legislator)) %></h2>

<div id="leftWidgetColumn">

  <div id="widgetDirections">
    <p id="directions">
      Choose a Widget size below and alter content and style with the available dropdowns. Click Generate Widget to get your embed code and add to your site.
    </p>
    
    <!-- Not sure if this is how we're going to do it
      <span id="dataSource">Where the data is from</span>
      <span id="dataWhen">Last pull</span>
    -->
  </div>
  
  <div id="widgetStage">
    <div class="widgetSizes">
      <h3>Choose Size</h3>
      
      <ul id="switcher">
        <li class="switcherbtn"><%= link_to "160 x 300", '#', :id => "sm" %></li>
        <li class="switcherbtn"><%= link_to "300 x 250", '#', :id => "med" %></li>
        <li class="switcherbtn"><%= link_to "400 x 300", '#', :id => "lg" %></li>
      </ul>
      
      <div class="clear"></div>
    </div>
    
    <div id="widgetConstruct">
      <iframe src='http://<%= settings[:frontend_hostname] %>/widgets/<%= params[:id] %>/embed?bioguide_id=<%= params[:bioguide_id] %>&size=lg' width='<%= @width %>' height='<%= @height %>' frameborder='0'></iframe>
    </div>
        
  </div>
  
</div>

<div id="rightWidgetColumn">

    <fieldset class="custom">
      <legend>Style</legend>
      <ul>
        <li>
          <select id="primaryColor">
            <option value="">Choose a Color</option>
            <option value="red">Red</option>
            <option value="orange">Orange</option>
            <option value="yellow">Yellow</option>
            <option value="green">Green</option>
            <option value="blue">Blue</option>
            <option value="indigo">Indigo</option>
            <option value="violet">Violet</option>
            <option value="black">Black</option>
            <option value="white">White</option>
            <option value="gray">Gray</option>
          </select>
        </li>
      </ul>
    </fieldset>
    
    <div id="colorPicker"></div>
    
    <!-- This is where a widget-specific form partial will go, if necessary
    <fieldset class="custom"> 
      <legend>Content</legend>
      
    </fieldset>
    -->
    
    <ul>
      <li>
        <label id="checkBoxType">
          <input class="checkbox" type="checkbox" name="freezeDate"/>
          &nbsp;&nbsp;Check box to freeze data from updating
        </label>
      </li>
      <li>
        <button id="generate" class="generate" type="submit">
          <span>Generate Widget</span>
        </button>
      </li>
    </ul>
  
  <div id="embedCode">
    <span>Embed Code</span>
    <input id="grabCode" name="widgetCode" type="text"/>
  </div>
  
</div>