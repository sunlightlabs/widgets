<% content_for :head do %>
  <script type="text/javascript">
    var frontend_hostname = "<%= settings[:frontend_hostname] %>";
    var widget_id = "<%= params[:id] %>";
    var bioguide_id = "<%= params[:bioguide_id] %>";
    
    // various globals to help out in keeping state of the widget during customization
    var sizes = {sm: [160, 300], med: [300, 250], lg: [400,300]};
    var widget_size = 'lg';

    // should be filled in with any default values before the document is ready
    var custom = {};

    // fill in this object in the widget-specific form partial to have them included in any 
    // snapshot request to Drumbone
    var snapshot = {};
    
    // this will get filled in when someone clicks the freeze checkbox
    var snapshot_id = null;
  </script>
  <%= javascript_include_tag 'customize' %>
<% end %>
<% content_for :title, h(@widget[:name] + " for " + search_name_for(@legislator)) %>

<h2>
  <%= h @widget[:name] %>
  for
  <%= search_name_for @legislator %>
</h2>

<div id="leftWidgetColumn">

  <div id="widgetDirections">
    <p id="directions">
      Pick from the sizes below<%= ", and use the controls to the right to customize your widget" if @widget[:custom] %>.  Copy the embed code at any time to place the widget on your website.
    </p>
  </div>
  
  <div id="widgetStage">
    <div class="widgetSizes">
      <h3>Choose Size</h3>
      
      <ul id="switcher">
        <li class="switcherbtn"><%= link_to "160 x 300", '#', :id => "sm" %></li>
        <li class="switcherbtn"><%= link_to "300 x 250", '#', :id => "med" %></li>
        <li class="switcherbtn"><%= link_to "400 x 300", '#', :id => "lg" %></li>
      </ul>
      
      <div class="clear"></div>
    </div>
    
    <div id="widgetConstruct">
      <iframe frameborder='0'></iframe>
    </div>
        
  </div>
  
</div>

<div id="rightWidgetColumn">
    
    <%= render :partial => "widgets/form/#{params[:id]}" %>
    
    <ul id="freezeBox"><li>
      <label id="checkBoxType">
        <input class="checkbox" type="checkbox" id="freeze" name="freezeDate"/>
        &nbsp;&nbsp;Check box to freeze data from updating
      </label>
    </li></ul>
    
    <div id="loadingBox">
      <%= image_tag "site/spinner.gif" %>
      <span>Freezing the data...</span>
    </div>
    
    <div id="errorBox"></div>
  
  <div id="embedCode">
    <span>Embed Code</span>
    <input id="grabCode" name="widgetCode" type="text"/>
  </div>
  
</div>